name: Build and push Docker image of findPeek 

on:
  push:
    branches:
      - main
  pull_request:
    branches:  
      -main 

jobs:
  build-and-push:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3


      - name: Build Docker image
        run: |
          docker build -t rachelbenpo/togatest:latest .
         # docker run -e PARAMS="1 2 3" togatest:latest
         # docker run -e PARAMS="4 6 5" togatest:latest
         # docker run -e PARAMS="1 2 1" togatest:latest

          
    #  - name: Push Docker image to GitHub Packages
    #    uses: docker/build-push-action@v3
    #    with:
     #     repository: rachelbenpo/togatest
     #     tag: latest


      - name: push Docker image
        run: |
         
          # Authenticate with GitHub Container Registry
          echo ${{ secrets.GITHUB_TOKEN }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin

          # Push Docker image to GitHub Container Registry
          docker build -t ghcr.io/rachelbenpo/togatest:latest -t ghcr.io/rachelbenpo/togatest:${{ github.sha }} --push .

          # Run Docker image 
          docker run -e PARAMS="1 2 3" ghcr.io/rachelbenpo/togatest:latest
          docker run -e PARAMS="4 6 5" ghcr.io/rachelbenpo/togatest:latest
          docker run -e PARAMS="1 2 1" ghcr.io/rachelbenpo/togatest:latest


